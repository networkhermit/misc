#!/bin/bash

if [ "${OSTYPE}" != 'linux-gnu' ]; then
    echo "✗ unknown os type: ‘${OSTYPE}’" 1>&2
    exit 1
fi

# shellcheck disable=SC1090
source <(grep '^ID=' /etc/os-release)
DISTRO=${ID:-linux}

uname --kernel-name --kernel-release --kernel-version --machine

case "${DISTRO}" in
    arch)
        pacman --query linux{,-api-headers,-docs,-headers}
        ;;
    fedora)
        rpm --query kernel{,-devel,-headers}
        ;;
    kali)
        dpkg --get-selections linux-{doc,headers,image}-[0-9]\*
        ;;
    manjaro)
        pacman --query linux{,-api-headers,-headers}
        ;;
    opensuse*)
        rpm --query kernel-{default{,-devel},devel,docs}
        ;;
    ubuntu)
        dpkg --get-selections linux-{doc,headers,image}-[0-9]\*
        ;;
    *)
        echo "✗ unknown distro: ‘${DISTRO}’" 1>&2
        exit
        ;;
esac
