#!/bin/bash

if [ "${OSTYPE}" != 'linux-gnu' ]; then
    echo "✗ unknown os type: ‘${OSTYPE}’" 1>&2
    exit 1
fi

# shellcheck disable=SC1090
source <(grep '^ID=' /etc/os-release)
DISTRO=${ID:-linux}

uname --machine --kernel-release --kernel-version

case "${DISTRO}" in
    arch | manjaro)
        pacman --query 'linux'
        ;;
    fedora)
        rpm --query 'kernel'
        ;;
    kali | ubuntu)
        dpkg --get-selections 'linux-image-[0-9]*' | tac
        ;;
    opensuse*)
        rpm --query 'kernel-default'
        ;;
    *)
        echo "✗ unknown distro: ‘${DISTRO}’" 1>&2
        exit
        ;;
esac
