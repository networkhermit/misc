#!/bin/bash

# shellcheck disable=SC1090
source "$(dirname "$(dirname "$(realpath "${0}")")")/.privacy/slack.cfg"

TEXT=''
while read -r line; do
    TEXT+=${line}
    TEXT+=$'\n'
done

TEXT=$'```\n'"${TEXT}"$'```\n'

TEXT=$(python3 -c 'import json; print(json.dumps("""'"${TEXT}"'"""))')

curl -sS -X POST \
    -H 'Content-Type: application/json' \
    -d '{"mrkdwn": true, "text": '"${TEXT}"'}' \
    "${END_POINT}"
