#!/bin/bash

# shellcheck disable=SC1090
source "$(dirname "$(dirname "$(realpath "${0}")")")/.privacy/slack.cfg"

TEXT=''
while IFS='' read -r LINE; do
    TEXT+=${LINE}
    TEXT+=$'\n'
done

TEXT=$'```\n'"${TEXT}"$'```\n'

TEXT=$(python3 -c 'import json, sys; print(json.dumps(sys.stdin.read()))' <<< "${TEXT}")

curl --silent --show-error --request POST \
    --header 'Content-Type: application/json' \
    --data '{"mrkdwn": true, "text": '"${TEXT}"'}' \
    "${END_POINT}"
