#!/bin/bash

# shellcheck disable=SC1090
source "$(dirname "$(dirname "$(realpath "${0}")")")/.privacy/gotify.cfg"

TEXT=''
while IFS='' read -r LINE; do
    TEXT+=${LINE}
    TEXT+=$'\n'
done

TEXT=$(python3 -c 'import json, sys; print(json.dumps(sys.stdin.read()))' <<< "${TEXT}")

curl --silent --show-error --request POST \
    --header 'Content-Type: application/json' \
    --data '{"message": '"${TEXT}"', "priority": 5, "title": "notice"}' \
    "${END_POINT}/message?token=${APP_TOKEN}"
